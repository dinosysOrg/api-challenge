<div style="padding: 10px">
		<h3 align="center"><code>All Players</code></h3>
		<div class="table-responsive">
			<table id="table_player" class="table table-striped table-bordered">
				<thead style="color: green">
					<tr>
						<th>Name</th>
						<th>Group</th>
						<th>Score</th>
						<th>Action</th>
						<th>Action</th>
					</tr>
				</thead>
				<tbody>
					<% @players.each do |player| %>
						<tr>
							<td>
								<span player_id="<%= player.id %>" data-name="name" class="players" data-type="text" data-pk="1" data-title="Enter name"><%= player.name %></span>
							</td>
							<td>
								<% if player.group.nil? %>
									
								<% else %>
									<span player_id="<%= player.id %>" data-name="group_id" class="player_group" data-type="select" data-pk="2" data-title="Enter name"><%= player.group.name %></span>
								<% end %>
							</td>
							<td><%= player.score %></td>
							<td id="<%= player.id %>" class="delete_player">Delete</td>
							<td><%= link_to "Show", player  , onclick: "window.location.reload();" %></td>
						</tr>
					<% end %>
				</tbody>
			</table>
		</div>
		<h4 align="center"><code><%= link_to "New Player", new_player_path %></code></h4>

</div>

<script>
	$(".delete_player").click(function() {
    swal({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        type: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
    }).then((result) => {
        if (result) {
            $.ajax({
                type: "POST",
                url: "/destroy_player",
                data: {
                    id: this.id
                },
                success: (response) => {
                    if (response.status == "success") {
                        swal(
                            'Wohooo!',
                            response.message,
                            'success'
                        )

                        $(this).parent().fadeOut();
                    } else {
                        swal(
                            'Oops...',
                            response.message,
                            'error'
                        )
                    }
                }
            });
                       
        }
    })
});


	$(".players").editable({
			url: "/update_player",
			type: 'post',
			params: function(params){
                var player_id = $(this).attr("player_id");
                params.id = player_id;
                return params;                
			},
	    success: (response) => {
	        if (response.status == "success") {
	            swal(
	                'Wohooo!',
	                response.message,
	                'success'
	            )

	        } else {
	            swal(
	                'Oops...',
	                response.message,
	                'error'
	            )
	        }
	    }
		})

	$(".player_group").editable({
			url: "/update_player",
			type: 'post',
			source: [
              <% Group.all.each do |group| %>
              	{value: "<%= group.id %>", text: "<%= group.name %>"},
              <% end %>
           ],
			params: function(params){
                var player_id = $(this).attr("player_id");
                params.id = player_id;
                return params;                
			},
	    success: (response) => {
	        if (response.status == "success") {
	            swal(
	                'Wohooo!',
	                response.message,
	                'success'
	            )

	        } else {
	            swal(
	                'Oops...',
	                response.message,
	                'error'
	            )
	        }
	    }
		})
</script>
